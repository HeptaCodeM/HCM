<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hcm.grw.model.mapper.hr.CommonCodeDaoImpl">
	

	<select id="selectAllDept" resultType="CommonCodeDto">
		SELECT 
		      COCO_CD, COCO_NAME 
		FROM    COMMON_CODE
		WHERE    COCO_DELFLAG = 'N'
		AND      SUBSTR(COCO_CD, 1, 2) = 'DT'
		AND      COCO_PARENT_ID IS NOT NULL
		ORDER BY COCO_CD ASC
	</select>
	
	<insert id="insertDeptOne" parameterType="java.util.Map">
		INSERT INTO COMMON_CODE (COCO_CD, COCO_NAME, COCO_PARENT_ID, COCO_CREATE_ID)
						VALUES(#{coco_cd}, #{coco_name}, (
						                     SELECT 
						                           COCO_CD
						                     FROM    COMMON_CODE
						                     WHERE    COCO_DELFLAG = 'N'
						                     AND      SUBSTR(COCO_CD, 1, 2) = 'DT'
						                     AND      COCO_PARENT_ID IS NULL
						                     ), #{coco_create_id})
	</insert>
	
	<update id="deleteDeptOne" parameterType="java.util.Map">
		UPDATE COMMON_CODE SET COCO_DELFLAG = 'Y'
			WHERE COCO_CD = #{coco_cd}
	</update>
	
	<select id="selectOneDept" parameterType="java.util.Map" resultType="CommonCodeDto">
		SELECT 
		      COCO_CD , COCO_NAME
		FROM    COMMON_CODE
		WHERE    COCO_DELFLAG = 'N'
		AND      SUBSTR(COCO_CD, 1, 2) = 'DT'
		AND      COCO_PARENT_ID IS NOT NULL
		AND 	 COCO_CD = #{coco_cd}
	</select>
	
	<update id="correctionDept" parameterType="java.util.Map">
		UPDATE COMMON_CODE SET COCO_NAME = #{coco_name}
			WHERE COCO_CD = #{coco_cd}
	</update>
	
	<!-- ============================= 구분선 ============================= -->
	
	<select id="selectAllRank" resultType="CommonCodeDto">
		SELECT 
		      COCO_CD, COCO_NAME 
		FROM    COMMON_CODE
		WHERE    COCO_DELFLAG = 'N'
		AND      SUBSTR(COCO_CD, 1, 2) = 'RK'
		AND      COCO_PARENT_ID IS NOT NULL
		ORDER BY COCO_CD ASC
	</select>
	
	<update id="insertRankOne" parameterType="java.util.Map">
		INSERT INTO COMMON_CODE (COCO_CD, COCO_NAME, COCO_PARENT_ID, COCO_CREATE_ID)
			VALUES(#{coco_cd}, #{coco_name},( 
								SELECT 
								      COCO_CD 
								FROM    COMMON_CODE
								WHERE    COCO_DELFLAG = 'N'
								AND      SUBSTR(COCO_CD, 1, 2) = 'RK'
								AND      COCO_PARENT_ID IS NULL
								),  #{coco_create_id})
	</update>
	
	<update id="deleteRankOne" parameterType="java.util.Map">
		UPDATE COMMON_CODE SET COCO_DELFLAG = 'Y'
			WHERE COCO_CD = #{coco_cd}
	</update>
	
	<select id="selectOneRank" resultType="CommonCodeDto">
		SELECT 
		      COCO_CD , COCO_NAME
		FROM    COMMON_CODE
		WHERE    COCO_DELFLAG = 'N'
		AND      SUBSTR(COCO_CD, 1, 2) = 'RK'
		AND      COCO_PARENT_ID IS NOT NULL
		AND 	 COCO_CD = #{coco_cd}
	</select>
	
	<update id="correctionRank" parameterType="java.util.Map">
		UPDATE COMMON_CODE SET COCO_NAME = #{coco_name}
			WHERE COCO_CD = #{coco_cd}
	</update>
	
	<!-- ============================= 구분선 ============================= -->
	
	<select id="selectAllPosition" resultType="CommonCodeDto">
		SELECT 
		      COCO_CD, COCO_NAME 
		FROM    COMMON_CODE
		WHERE    COCO_DELFLAG = 'N'
		AND      SUBSTR(COCO_CD, 1, 2) = 'PN'
		AND      COCO_PARENT_ID IS NOT NULL
		ORDER BY COCO_CD ASC
	</select>
	
	<update id="insertPositionOne" parameterType="java.util.Map">
		INSERT INTO COMMON_CODE (COCO_CD, COCO_NAME, COCO_PARENT_ID, COCO_CREATE_ID)
			VALUES(#{coco_cd}, #{coco_name},( 
								SELECT 
								      COCO_CD 
								FROM    COMMON_CODE
								WHERE    COCO_DELFLAG = 'N'
								AND      SUBSTR(COCO_CD, 1, 2) = 'PN'
								AND      COCO_PARENT_ID IS NULL
								),  #{coco_create_id})
	</update>
	
	<update id="deletePositionOne" parameterType="java.util.Map">
		UPDATE COMMON_CODE SET COCO_DELFLAG = 'Y'
			WHERE COCO_CD = #{coco_cd}
	</update>
	
	<select id="selectOnePosition" resultType="CommonCodeDto">
		SELECT 
		      COCO_CD , COCO_NAME
		FROM    COMMON_CODE
		WHERE    COCO_DELFLAG = 'N'
		AND      SUBSTR(COCO_CD, 1, 2) = 'PN'
		AND      COCO_PARENT_ID IS NOT NULL
		AND 	 COCO_CD = #{coco_cd}
	</select>
	
	<update id="correctionPosition" parameterType="java.util.Map">
		UPDATE COMMON_CODE SET COCO_NAME = #{coco_name}
			WHERE COCO_CD = #{coco_cd}
	</update>
	
	<!-- ============================= 구분선 ============================= -->
	
</mapper>
